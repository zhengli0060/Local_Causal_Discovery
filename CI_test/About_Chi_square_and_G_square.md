## Chi-square 条件独立性检验 vs G² 条件独立性检验

Chi-square 条件独立性检验（Chi-square Conditional Independence Test）和 G² 条件独立性检验（G-squared Test for Conditional Independence）都是用于**分类变量之间的条件独立性检验**的统计方法，常用于贝叶斯网络结构学习等任务。它们都基于**离散频数表（contingency table）**，但存在一些关键区别和适用场景。

---

### 🔸1. 核心思想对比

| 特点 | Chi-square 检验 | G² 检验（似然比检验） |
|------|------------------|------------------------|
| 统计量形式 | 基于 Pearson 残差 | 基于似然比（log-likelihood ratio） |
| 统计量计算公式 | $\chi^2 = \sum \frac{(O - E)^2}{E}$ | $G^2 = 2 \sum O \log\left(\frac{O}{E}\right)$ |
| 对应分布 | 近似服从卡方分布 | 近似服从卡方分布 |

其中：
- \( O \)：观察频数（observed count）  
- \( E \)：期望频数（expected count）

---

### 🔸2. 理论与实践差异

| 方面 | Chi-square 检验 | G² 检验 |
|------|------------------|----------|
| 假设 | 假设数据服从多项分布，检验是否与期望频数有显著差异 | 假设数据服从最大似然估计下的模型，对数似然的差异用来判断是否独立 |
| 数学直觉 | 更直观，残差平方 | 与似然函数密切相关，更符合统计推断理论 |
| 对小样本的鲁棒性 | 对稀疏表格更敏感，可能不稳定 | 相对稳定，尤其在样本较小或稀疏的情况下更稳健 |

---

### 🔸3. 使用场景

| 场景 | 推荐方法 |
|------|----------|
| 样本量大、频数较平衡 | Chi-square 或 G² 都可以 |
| 样本量较小，或 contingency table 稀疏 | **G² 更推荐** |
| 使用信息论解释（如构建贝叶斯网络） | **G² 更常用** |
| 教学或简单统计报告 | Chi-square 更直观 |

---

### 🔸4. 在结构学习中的应用（如贝叶斯网络）

在贝叶斯网络的结构学习（constraint-based 方法，如 PC 算法）中：

- **G² test** 常用于：
  - `bnlearn` 等结构学习包中
  - 与最小描述长度（MDL）或 BIC 准则兼容
  - 小样本或复杂网络推理

- **Chi-square test**：
  - 用于快速粗略判断
  - 样本足够、结构简单的情况下适用

---

### 🔸总结一句话：

> **G² 检验更符合统计推断与信息准则，适用于样本量较小或模型推理中；Chi-square 检验更简单直观，适用于样本充足时的快速判断。**

---

### 🔹实际使用建议

如果使用 R 或 Python 进行结构学习，可以根据包中设置选择检验方法：

- R 中 `bnlearn::ci.test()`：
  - `test = "x2"` 表示 Pearson Chi-square 检验
  - `test = "g2"` 表示 G² 检验

- Python 中 `pgmpy` 等库中通常也支持类似选择。

---

